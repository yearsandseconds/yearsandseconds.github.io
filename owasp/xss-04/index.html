<!DOCTYPE html>
<html lang="en-us">
  <head><link rel="icon" href="/favicon_main.svg"><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="x-ua-compatible" content="ie=edge" /><meta property="og:url"  content="https://marianneharju.com/owasp/xss-04/" />
    <meta property="og:type" content="article" /><meta property="og:title" content="Reflected XSS with SVG Markup" /><meta property="og:description" content="Reflected XSS with some SVG markup allowed" /><meta property="og:image:width"  content="600" />
        <meta property="og:image:height" content="188" /><meta property="og:image" content="https://marianneharju.com/owasp/xss-04/XSS04_05_hu41e0aaef2193bc587fa2edba83e5aac2_84102_600x0_resize_box_3.png" /><title>Personal website and blog - Reflected XSS with SVG Markup</title>

    
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/style.sass">
<link rel="stylesheet" type="text/css" href="/css/monokai-sublime.9.15.8.min.css">
<link rel="stylesheet" type="text/css" href="/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/css/refresh.css">
<link rel="stylesheet" type="text/css" href="/css/devicon.min.css">
    

  </head>
  <body>
     

    <div id="preloader">
      <div id="status"></div>
    </div><nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">

      
      
      
      <a class="navbar-item">
        <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
        <div class="navbar-item left-menu-icon-wrapper">
          Tags
        </div>
      </a>

      <div class="navbar-item is-expanded"></div>
      <a class="navbar-item is-hidden-desktop">  
        <div data-target="navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
          Menu
        </div>
        <div data-target="navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>
    </div><div id="navbar-menu" class="navbar-menu is-static">
      
      <div class="navbar-end">
        
          <a href="/" class="navbar-item is-secondary">Home</a><a href="/about/" class="navbar-item is-secondary">About Me</a><a href="/ctf/" class="navbar-item is-secondary">CTF</a><a href="/owasp/" class="navbar-item is-secondary">OWASP TOP-10</a>
        
        
        
        
        
        
        
      </div>
    </div>
  </div>
</nav>
<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
      <div class="navbar-brand">
  
        
        
        
        <a class="navbar-item">
          <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
          <div class="navbar-item left-menu-icon-wrapper">
            Tags
          </div>
        </a>
  
        <div class="navbar-item is-expanded"></div>
        <a class="navbar-item is-hidden-desktop">  
          <div data-target="cloned-navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
            Menu
          </div>
          <div data-target="cloned-navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div><div id="cloned-navbar-menu" class="navbar-menu is-static">
        <div class="navbar-end"><a href="/" class="navbar-item is-secondary">Home</a><a href="/about/" class="navbar-item is-secondary">About Me</a><a href="/ctf/" class="navbar-item is-secondary">CTF</a><a href="/owasp/" class="navbar-item is-secondary">OWASP TOP-10</a>
          
          
          

          
          
          
        
        </div>
      </div>
    </div>
  </nav>
<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title is-2 section-title">Reflected XSS with SVG Markup</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
        
        <section class="section content has-text-justified">
          <p>Level: <strong>Practitioner</strong></p>
<p>Today we will solve Portswigger&rsquo;s &ldquo;Reflected XSS with some SVG markup allowed&rdquo; lab from their XSS (Cross-site scripting) series.</p>
<p>This is the information that we are starting with:</p>
<article class="message">
    <div class="message-body">
        
         
            This lab has a simple reflected XSS vulnerability. The site is blocking common tags but misses some SVG tags and events.
To solve the lab, perform a cross-site scripting attack that calls the &ldquo;alert()&rdquo; function.
        
    </div>
</article>
<p>When we open the lab, we see a search bar. Let&rsquo;s try entering a random XSS payload there. For example I tried <code>&lt;script&gt;alert(1)&lt;/script&gt;</code> and <code>&lt;img src=1 onerror=alert(1)&gt;</code>, both of which returned a &ldquo;Tag is not allowed error&rdquo;.</p>
<p>Okay, so it looks like (at least some, probably most) tags are blocked. The next thing that we might want to do is to see whether we can find any tags that are not blocked. For this we can use Burp Intruder. Let&rsquo;s find the <code>GET /?search=payload</code> request in HTTP History and send it to the Intruder. Then let&rsquo;s click &ldquo;Clear §&rdquo;, insert angle brackets instead of our previous payload and then let&rsquo;s click &ldquo;Add §&rdquo; twice between the angle brackets so the value of the search term is now <code>&lt;§§&gt;</code> :</p>
<p><img src="/Images/XSS04_images/XSS04_01.png" alt=""></p>
<p>Now we need to add some payloads. For this we can use Portswigger&rsquo;s handy <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">XSS cheat sheet</a> . Let&rsquo;s click &ldquo;Copy tags to clipboard&rdquo;, then let&rsquo;s open the &ldquo;Payloads&rdquo; tab in the Intruder and paste the tags under the &ldquo;Payload settings&rdquo; option:</p>
<p><img src="/Images/XSS04_images/XSS04_02.png" alt=""></p>
<p>Then let&rsquo;s start the attack. Once we have the results, we can sort them by status. We see that the majority of payloads result in a 400 status code, but there are a few that give us a much happier 200 response!:</p>
<p><img src="/Images/XSS04_images/XSS04_03.png" alt=""></p>
<p>When we take a look at the cheat sheet again, we can see that <code>&lt;animatetransform&gt;</code> is a tag that is used within the <code>&lt;svg&gt;</code> tag. Luckily for us, neither of the tags is blocked, so let&rsquo;s try finding a working payload containing these two tags. For that we need to choose &ldquo;svg-&gt;animatetransform&rdquo;, &ldquo;all events&rdquo; and &ldquo;all browsers&rdquo; in the cheat sheet:</p>
<p><img src="/Images/XSS04_images/XSS04_04.png" alt=""></p>
<p>As a result, we see three event handlers that don&rsquo;t require user interaction, so let&rsquo;s try these out:</p>
<p><img src="/Images/XSS04_images/XSS04_05.png" alt=""></p>
<p>After trying these three, it turns out that only the first one gives us a popup, the other two result in an &ldquo;Event is not allowed&rdquo; error. Since there were only three options to try out, I did it manually, but in case of more options it wouldn&rsquo;t be so convenient to try them out one by one. In that case Burp Intruder would help us out again, so let&rsquo;s see how to use that instead of this manual approach.</p>
<p>Let&rsquo;s go back to the Intruder and replace our current payload with <code>&lt;svg&gt;&lt;animatetransform%20=1&gt;</code>, then let&rsquo;s add two § signs before the = sign, so now the value of the search term is <code>&lt;svg&gt;&lt;animatetransform%20§§=1&gt;</code> :</p>
<p><img src="/Images/XSS04_images/XSS04_06.png" alt=""></p>
<p>Now we need to add a payload list. Let&rsquo;s click &ldquo;Copy events to clipboard&rdquo; in the XSS cheat sheet, open the &ldquo;Payloads&rdquo; tab in the Intruder and paste the tags under the &ldquo;Payload settings&rdquo; option, just like before. Then let&rsquo;s start the attack. As expected, we only get one result with the 200 status code and that is &ldquo;onbegin&rdquo;:</p>
<p><img src="/Images/XSS04_images/XSS04_07.png" alt=""></p>
<p>Then we find the correct payload in the cheat sheet, enter that into the search bar, et voilà, the lab is solved!</p>

        </section>
      </div>
    </div>
  </div>  
  </section>
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <img src="/images/mh_logo.png" alt="">
        
      </div>
      
    <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Website</h3>
          </div>
          <ul class="link-list"><li></li>
            <li><a href="/tags/">
                <span class="icon"><i class="fa fa-tag"></i></span> 
                All Tags
              </a></li>
          </ul>
        </div>
      </div>
    
      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Contacts</h3>
          </div>
          <ul class="link-list">
            
            <li>
              <a href="https://www.linkedin.com/in/marianne-harju-a80368260/" target="_blank">
                <span class="icon"><i class="fab fa-linkedin"></i></span>
                
                  My LinkedIn
                
              </a>
            </li>
            
                         
            
            <li>
              <a href="mailto:name.surname@domain.com" target="_blank">
                <span class="icon"><i class="fa fa-envelope"></i></span>
                
                  My Email
                
              </a>
            </li>
            
                   
                   
            
            
                         
       
          </ul>
        </div>
      </div>
      

      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Copyright</h3>
          </div>
          <ul class="link-list">
            <li>
              <a>
                <span class="icon"><i class="fa fa-copyright"></i></span>
                Maru - 2023
              </a>
            </li>
          </ul>
        </div>
      </div>
      

    </div>
  </div>
</footer>
    <div id="backtotop"><a href="#"></a></div><div class="sidebar scroll">
  <div class="sidebar-header"><img src="/sidebar.svg" alt="">
    
    <a class="sidebar-close" href="javascript:void(0);">
      <i data-feather="x"></i>
    </a>
  </div>
  <div class="inner">
    <ul class="sidebar-menu">
      <li class="no-children"><a href="/tags/"><div class="columns">
              <table width="100%">  
                <tr>
                  <td class="">
                    <span class="icon"><i class="fa fa-cubes"></i></span>
                    All Tags
                  </td>
                  <td class="has-text-right" >
                      
                  </td>
                </tr>
              </table>
            </div>
          </a>
      <li class="no-children">
          <a href="/tags/portswigger-labs">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>PortSwigger Labs</td>
                    <td class="has-text-right" >
                        <div class="tag-number">8</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/xss">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>XSS</td>
                    <td class="has-text-right" >
                        <div class="tag-number">4</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/xxe">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>XXE</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/ctf">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>CTF</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/file-upload-issues">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>File Upload Issues</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/ssrf">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>SSRF</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/tryhackme">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>TryHackMe</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li></ul>
  </div>
</div>
<script src="/js/jquery-2.2.4.js"></script>
  <script src="/js/feather.4.22.0.js"></script>
  <script src="/js/modernizr-3.6.0.js"></script>
  <script src="/js/refresh.js"></script><script>
  window.MathJax = {
    loader: {
      load: ['core', 'input/tex-base', 'output/chtml'],  
      source: {
        'core': '\/js\/mathjax\/core.js',
        'input/tex-base': '\/js\/mathjax\/tex-base.js',
        'output/chtml': '\/js\/mathjax\/chtml.js',
        'output/chtml/fonts/tex': '\/js\/mathjax\/tex_out.js'
      },
    },
    chtml: {
      fontURL: '/fonts' 
    },
  };
</script><script src="/js/mathjax/startup.js"></script>
  <script src="/js/highlight.9.18.1.js"></script>
  <script src="/js/highlightjs-line-numbers.2.7.0.min.js"></script><script>
  hljs.initHighlightingOnLoad();
  hljs.initLineNumbersOnLoad();
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('.codeinline').forEach((block) => {
      hljs.highlightBlock(block);
    });
  });
</script>

</body>
</html>
