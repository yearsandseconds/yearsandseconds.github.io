<!DOCTYPE html>
<html lang="en-us">
  <head><link rel="icon" href="/favicon_main.svg"><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="x-ua-compatible" content="ie=edge" /><meta property="og:url"  content="https://marianneharju.com/owasp/xss-01/" />
    <meta property="og:type" content="article" /><meta property="og:title" content="Reflected XSS into attribute with angle brackets HTML-encoded" /><meta property="og:description" content="Reflected XSS into attribute with angle brackets HTML-encoded" /><meta property="og:image:width"  content="600" />
        <meta property="og:image:height" content="194" /><meta property="og:image" content="https://marianneharju.com/owasp/xss-01/XSS01_08_hu31fbcab7766d3219df4034e93f7c685d_13167_600x0_resize_q75_box.jpg" /><title>Personal website and blog - Reflected XSS into attribute with angle brackets HTML-encoded</title>

    
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/css/style.css">
<link rel="stylesheet" type="text/css" href="/css/monokai-sublime.9.15.8.min.css">
<link rel="stylesheet" type="text/css" href="/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/css/refresh.css">
<link rel="stylesheet" type="text/css" href="/css/devicon.min.css">
    

  </head>
  <body>
     

    <div id="preloader">
      <div id="status"></div>
    </div><nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">

      
      
      
      <a class="navbar-item">
        <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
        <div class="navbar-item left-menu-icon-wrapper">
          Tags
        </div>
      </a>

      <div class="navbar-item is-expanded"></div>
      <a class="navbar-item is-hidden-desktop">  
        <div data-target="navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
          Menu
        </div>
        <div data-target="navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>
    </div><div id="navbar-menu" class="navbar-menu is-static">
      
      <div class="navbar-end">
        
          <a href="/" class="navbar-item is-secondary">Home</a><a href="/about/" class="navbar-item is-secondary">About Me</a><a href="/ctf/" class="navbar-item is-secondary">CTF</a><a href="/owasp/" class="navbar-item is-secondary">OWASP TOP-10</a>
        
        
        
        
        
        
        
      </div>
    </div>
  </div>
</nav>
<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
      <div class="navbar-brand">
  
        
        
        
        <a class="navbar-item">
          <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
          <div class="navbar-item left-menu-icon-wrapper">
            Tags
          </div>
        </a>
  
        <div class="navbar-item is-expanded"></div>
        <a class="navbar-item is-hidden-desktop">  
          <div data-target="cloned-navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
            Menu
          </div>
          <div data-target="cloned-navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div><div id="cloned-navbar-menu" class="navbar-menu is-static">
        <div class="navbar-end"><a href="/" class="navbar-item is-secondary">Home</a><a href="/about/" class="navbar-item is-secondary">About Me</a><a href="/ctf/" class="navbar-item is-secondary">CTF</a><a href="/owasp/" class="navbar-item is-secondary">OWASP TOP-10</a>
          
          
          

          
          
          
        
        </div>
      </div>
    </div>
  </nav>
<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title is-2 section-title">Reflected XSS into attribute with angle brackets HTML-encoded</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
        
        <section class="section content has-text-justified">
          <p>Level: <strong>Apprentice</strong></p>
<p>Today we will solve Portswigger&rsquo;s &ldquo;Reflected XSS into attribute with angle brackets HTML-encoded&rdquo; lab from their XSS (Cross-site scripting) series.</p>
<p>This is what we know:</p>
<p><code>This lab contains a reflected cross-site scripting vulnerability in the search blog functionality where angle brackets are HTML-encoded. To solve this lab, perform a cross-site scripting attack that injects an attribute and calls the 'alert' function.</code></p>
<p>Let&rsquo;s go! When we open the lab, we see that it&rsquo;s a blog with several posts and a search bar at the top of the page. Since we know that there is a vulnerability in the search functionality, let&rsquo;s enter something random there and see where our input is reflected. I went with the representation of my feelings when I first wake up in the morning: &ldquo;aaaaaaaa&rdquo;.</p>
<p>Let&rsquo;s view page source:</p>
<p><img src="/images/XSS01_images/XSS01_01.png" alt=""></p>
<p>Next let&rsquo;s try out some symbols that we need for achieving XSS: angle brackets(&lt;&gt;), single quote (&rsquo;), double quote (&quot;):</p>
<p><img src="/images/XSS01_images/XSS01_02.png" alt=""></p>
<p>We can see that in the first instance all of these symbols are HTML-encoded but in the second case, inside the input tag, only angle brackets are encoded, but single quote and double quote are not. Okay, we can work with this&hellip;</p>
<p>Something that often comes in handy when dealing with XSS is <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">Portswigger&rsquo;s XSS cheat sheet</a> . Let&rsquo;s try finding a payload that we could use inside the input tag. For that we need to choose &ldquo;input&rdquo;, &ldquo;all events&rdquo; and &ldquo;all browsers&rdquo;:</p>
<p><img src="/images/XSS01_images/XSS01_03.png" alt=""></p>
<p>There are a lot of results, however not all of them usable in this case. Ideally I want to find something that is simple, can be used without angle brackets and is Chrome-compatible (since that&rsquo;s the browser I&rsquo;m currently using).</p>
<p>For example this onerror payload seems to meet the brief at first glance:</p>
<p><img src="/images/XSS01_images/XSS01_04.png" alt=""></p>
<p>However, when we try it out (I will explain how to alter the cheat sheet payload for our needs below) nothing happens because the input tag already has a &ldquo;type&rdquo; attribute and adding a second one will not really help our cause:</p>
<p><img src="/images/XSS01_images/XSS01_05.png" alt=""></p>
<p>So depending on the context this step might require a bit of trial and error to find what works, but that&rsquo;s all a part of the process!</p>
<p>Next in my search for something simple, Chrome-y and bracket-free, I see this onfocus payload that looks doable:</p>
<p><img src="/images/XSS01_images/XSS01_06.png" alt=""></p>
<p>Now, how to make this payload suitable? First we need to escape that morning &ldquo;aaaaaaaa&rdquo; feeling, which we can do by adding a double quote . Then let&rsquo;s add the rest of the payload and encode the spaces into %20 (or well, we can let our browser do that for us) so our payload will look like this:</p>
<p><code>?search=aaaaaaaa&quot;%20autofocus%20onfocus=alert(1)</code></p>
<p>Nothing happens and this is what the page source looks like:</p>
<p><img src="/images/XSS01_images/XSS01_07.png" alt=""></p>
<p>We can see that we managed to successfully escape the value attribute, but since we did that we have one leftover double quote at the very end of the tag. Let&rsquo;s try to fix it by adding another &quot; before alert(1) so that alert(1) would then be between quotes.</p>
<p><code>?search=aaaaaaaa&quot;%20autofocus%20onfocus=&quot;alert(1)</code></p>
<p>And now we have triggered the popup and the lab is solved!</p>
<p><img src="/images/XSS01_images/XSS01_08.png" alt=""></p>
<p>Let&rsquo;s check the page source once more to see what it looks like:</p>
<p><img src="/images/XSS01_images/XSS01_09.png" alt=""></p>
<p>Now we can see that there are not leftover characters anywhere and everything is looking nice and clean.</p>
<p>Of course, this is not the only payload out there that works in this scenario. For example the following would also do the trick:</p>
<p><code>&quot;%20onmouseover=&quot;alert(1)</code></p>
<p>However this one requires some user interaction to trigger XSS: someone out there needs to hover the mouse over the text in the search bar.</p>
<p>Well, that&rsquo;s it for today!</p>

        </section>
      </div>
    </div>
  </div>  
  </section>
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <img src="/images/mh_logo.png" alt="">
        
      </div>
      
    <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Website</h3>
          </div>
          <ul class="link-list"><li></li>
            <li><a href="/tags/">
                <span class="icon"><i class="fa fa-tag"></i></span> 
                All Tags
              </a></li>
          </ul>
        </div>
      </div>
    
      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Contacts</h3>
          </div>
          <ul class="link-list">
            
            <li>
              <a href="https://www.linkedin.com/in/marianne-harju-a80368260/" target="_blank">
                <span class="icon"><i class="fab fa-linkedin"></i></span>
                
                  My LinkedIn
                
              </a>
            </li>
            
                         
            
            <li>
              <a href="mailto:name.surname@domain.com" target="_blank">
                <span class="icon"><i class="fa fa-envelope"></i></span>
                
                  My Email
                
              </a>
            </li>
            
                   
                   
            
            
                         
       
          </ul>
        </div>
      </div>
      

      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Copyright</h3>
          </div>
          <ul class="link-list">
            <li>
              <a>
                <span class="icon"><i class="fa fa-copyright"></i></span>
                Maru - 2023
              </a>
            </li>
          </ul>
        </div>
      </div>
      

    </div>
  </div>
</footer>
    <div id="backtotop"><a href="#"></a></div><div class="sidebar scroll">
  <div class="sidebar-header"><img src="/sidebar.svg" alt="">
    
    <a class="sidebar-close" href="javascript:void(0);">
      <i data-feather="x"></i>
    </a>
  </div>
  <div class="inner">
    <ul class="sidebar-menu">
      <li class="no-children"><a href="/tags/"><div class="columns">
              <table width="100%">  
                <tr>
                  <td class="">
                    <span class="icon"><i class="fa fa-cubes"></i></span>
                    All Tags
                  </td>
                  <td class="has-text-right" >
                      
                  </td>
                </tr>
              </table>
            </div>
          </a>
      <li class="no-children">
          <a href="/tags/portswigger-labs">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>PortSwigger Labs</td>
                    <td class="has-text-right" >
                        <div class="tag-number">8</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/xss">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>XSS</td>
                    <td class="has-text-right" >
                        <div class="tag-number">4</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/xxe">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>XXE</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/ctf">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>CTF</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/file-upload-issues">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>File Upload Issues</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/ssrf">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>SSRF</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/tryhackme">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>TryHackMe</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li></ul>
  </div>
</div>
<script src="/js/jquery-2.2.4.js"></script>
  <script src="/js/feather.4.22.0.js"></script>
  <script src="/js/modernizr-3.6.0.js"></script>
  <script src="/js/refresh.js"></script><script>
  window.MathJax = {
    loader: {
      load: ['core', 'input/tex-base', 'output/chtml'],  
      source: {
        'core': '\/js\/mathjax\/core.js',
        'input/tex-base': '\/js\/mathjax\/tex-base.js',
        'output/chtml': '\/js\/mathjax\/chtml.js',
        'output/chtml/fonts/tex': '\/js\/mathjax\/tex_out.js'
      },
    },
    chtml: {
      fontURL: '/fonts' 
    },
  };
</script><script src="/js/mathjax/startup.js"></script>
  <script src="/js/highlight.9.18.1.js"></script>
  <script src="/js/highlightjs-line-numbers.2.7.0.min.js"></script><script>
  hljs.initHighlightingOnLoad();
  hljs.initLineNumbersOnLoad();
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('.codeinline').forEach((block) => {
      hljs.highlightBlock(block);
    });
  });
</script>

</body>
</html>
